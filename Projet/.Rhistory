mean.ci = TRUE,
type="p",
var.equal = T,
bf.message = FALSE,
)
#Les variances sont pas mal égale,
qqnorm(pG3[pStudyTime == 1])
qqline(pG3[pStudyTime == 1], col = "red")
qqnorm(pG3[pStudyTime == 2])
qqline(pG3[pStudyTime == 2], col = "red")
qqnorm(pG3[pStudyTime == 3])
qqline(pG3[pStudyTime == 3], col = "red")
qqnorm(pG3[pStudyTime == 4])
qqline(pG3[pStudyTime == 4], col = "red")
#Les données semblent suivent la loi normale
groupe1 <- pG3[pStudyTime == 1]
groupe2 <- pG3[pStudyTime == 2]
groupe3 <- pG3[pStudyTime == 3]
groupe4 <- pG3[pStudyTime == 4]
# Effectuer des tests t pour chaque paire de niveaux de studytime
p_values <- c(
t.test(groupe1, groupe2)$p.value,
t.test(groupe1, groupe3)$p.value,
t.test(groupe1, groupe4)$p.value,
t.test(groupe2, groupe3)$p.value,
t.test(groupe2, groupe4)$p.value,
t.test(groupe3, groupe4)$p.value
)
# Ajuster les p-valeurs pour les comparaisons multiples (Bonferroni)
p_values_adjusted <- p.adjust(p_values, method = "bonferroni")
# Afficher les résultats ajustés
p_values_adjusted
# p_values_adjusted: [1] 4.641942e-06 7.755940e-09 1.180120e-02 3.998751e-02 1.000000e+00 1.000000e+00
#######################################
# Maintenant la variable SchoolSup
psych::describeBy(mG3, group = mSchoolSup)
#grosse différence dans les variances
ggstatsplot::ggbetweenstats(
data = mathematique, x = schoolsup, y = G3,
title = "La note finale en fonction du temps de voyage",
mean.ci = TRUE,
type="p",
var.equal = F,
bf.message = FALSE,
)
#encore une grosse différence dans les variances, essayons une racine carré
mathematique$racineG3 <- sqrt(mathematique$G3)
ggstatsplot::ggbetweenstats(
data = mathematique, x = schoolsup, y = racineG3,
title = "La note finale en fonction du temps de voyage",
mean.ci = TRUE,
type="p",
var.equal = F,
bf.message = FALSE,
)
#Testons la normalité
qqnorm(mG3[mSchoolSup == "yes"])
qqline(mG3[mSchoolSup == "yes"], col = "red")
qqnorm(mG3[mSchoolSup == "no"])
qqline(mG3[mSchoolSup == "no"], col = "red")
#Les données suivent une loi normale
#ça améliore un peu les données, faisons un test t
t.test(racineG3 ~ schoolsup, data = mathematique, var.equal = T)
#p-value = 2.831e-06, donc oui l'école en plus est très significative, mais ça n'améliore pas la note, au contraire.
#------------------------
#Maintenant portugais
psych::describeBy(pG3, group = pSchoolSup)
#grosse différence dans les variances
ggstatsplot::ggbetweenstats(
data = portugais, x = schoolsup, y = G3,
title = "La note finale en fonction du temps de voyage",
mean.ci = TRUE,
type="p",
var.equal = F,
bf.message = FALSE,
)
#assez grosse différence dans les variances, essayons un log
portugais$logG3 <- log(portugais$G3)
ggstatsplot::ggbetweenstats(
data = portugais, x = schoolsup, y = logG3,
title = "La note finale en fonction du temps de voyage",
mean.ci = TRUE,
type="p",
var.equal = F,
bf.message = FALSE,
)
#N'améliore pas les variances
qqnorm(pG3[pSchoolSup == "yes"])
qqline(pG3[pSchoolSup == "yes"], col = "red")
qqnorm(pG3[pSchoolSup == "no"])
qqline(pG3[pSchoolSup == "no"], col = "red")
#ça suit une loi normale, donc faisons un test de welch
t.test(G3 ~ schoolsup, data = portugais, var.equal = F)
#C'est significatif (p-value = 0.001166), mais l'aide à l'école n'aide pas vraiment les notes.
#############################################################
#On est rendu à la variable mFamSup
############################################################
psych::describeBy(mG3, group = mFamSup)
#variance très proche, regardons visuellement
ggstatsplot::ggbetweenstats(
data = mathematique, x = famsup, y = G3,
title = "La note finale en fonction du temps de voyage",
mean.ci = TRUE,
type="p",
var.equal = F,
bf.message = FALSE,
)
#variance très semblable aussi, vérifions la normalité
qqnorm(mG3[mFamSup == "yes"])
qqline(mG3[mFamSup == "yes"], col = "red")
qqnorm(mG3[mFamSup == "no"])
qqline(mG3[mFamSup == "no"], col = "red")
#Les données suivent une loi normale, donc faisons un test t
t.test(G3 ~ famsup, data = mathematique, equal.var = T)
#p-value = 0.1469, donc il n'y a pas de différence avec la famille qui aide à la maison pour les math
#------------------------------------------#
# Portugais
psych::describeBy(pG3, group = pFamSup)
#Variance quasi identique
ggstatsplot::ggbetweenstats(
data = portugais, x = famsup, y = G3,
title = "La note finale en fonction du temps de voyage",
mean.ci = TRUE,
type="p",
var.equal = F,
bf.message = FALSE,
)
#Variance quasi identique
qqnorm(pG3[pFamSup == "yes"])
qqline(pG3[pFamSup == "yes"], col = "red")
qqnorm(pG3[pFamSup == "no"])
qqline(pG3[pFamSup == "no"], col = "red")
#suivent loi normale
t.test(G3 ~ famsup, data = portugais, equal.var = T)
#p-value = 0.9683, pour le portugais également, ça n'aide pas l'aide à la maison, ça ne change rien.
################################################################################
#Variable mPaid
psych::describeBy(mG3, group = mPaid)
#Variance très proche
ggstatsplot::ggbetweenstats(
data = mathematique, x = paid, y = G3,
title = "La note finale en fonction du temps de voyage",
mean.ci = TRUE,
type="p",
var.equal = F,
bf.message = FALSE,
)
#Variance toujours très proche
qqnorm(mG3[mPaid == "yes"])
qqline(mG3[mPaid == "yes"], col = "red")
qqnorm(mG3[mPaid == "no"])
qqline(mG3[mPaid == "no"], col = "red")
# Les données suivent une loi normale
t.test(G3 ~ paid, data = mathematique, var.equal = T)
#p-value = 0.6744, aucune différence pour mpaid
psych::describeBy(pG3, group = pPaid)
#Variance un peu éloigné
ggstatsplot::ggbetweenstats(
data = portugais, x = paid, y = G3,
title = "La note finale en fonction du temps de voyage",
mean.ci = TRUE,
type="p",
var.equal = F,
bf.message = FALSE,
)
#Les variances sont assé éloigné
#Essayons une racine carré
ggstatsplot::ggbetweenstats(
data = portugais, x = paid, y = racineG3,
title = "La note finale en fonction du temps de voyage",
mean.ci = TRUE,
type="p",
var.equal = F,
bf.message = FALSE,
)
#essayons un log
ggstatsplot::ggbetweenstats(
data = portugais, x = paid, y = logG3,
title = "La note finale en fonction du temps de voyage",
mean.ci = TRUE,
type="p",
var.equal = F,
bf.message = FALSE,
)
#aucune transformation ne fait vraiment mieux que les données sans transformations, vérifions la normalité
qqnorm(pG3[pPaid == "yes"])
qqline(pG3[pPaid == "yes"], col = "red")
qqnorm(pG3[pPaid == "no"])
qqline(pG3[pPaid == "no"], col = "red")
#Les données suivent une loi normale
t.test(G3 ~ paid, data = portugais, var.equal = F)
# p-value = 0.05082, on pourrait rejeter le test, mais on est presque pile sur le alpha = 5%, j'irais pour un rejet
#car les médiane sont égales et que la médiane résiste aux valeurs extrêmes, il y a aussi le fait que cela n'améliore pas
#la moyenne de la note, au pire, si c'était significatif, paid diminue la note moyenne des étudiants.
#############################################################
# Variable Internet
psych::describeBy(mG3, group = mInternet)
#Variance proche
ggstatsplot::ggbetweenstats(
data = mathematique, x = internet, y = G3,
title = "La note finale en fonction du temps de voyage",
mean.ci = TRUE,
type="p",
var.equal = F,
bf.message = FALSE,
)
#Variance proche
ggstatsplot::ggbetweenstats(
data = mathematique, x = internet, y = logG3,
title = "La note finale en fonction du temps de voyage",
mean.ci = TRUE,
type="p",
var.equal = F,
bf.message = FALSE,
)
#variance encore plus proche
qqnorm(mG3[mInternet == "yes"])
qqline(mG3[mInternet == "yes"], col = "red")
qqnorm(mG3[mInternet == "no"])
qqline(mG3[mInternet == "no"], col = "red")
# Les données suivent une loi normale
t.test(logG3 ~ internet, data = mathematique, var.equal = T)
#p-value = 0.0353, l'internet semble montré une différence, elle semble aider!
psych::describeBy(pG3, group = pInternet)
#Variance peu éloigné
ggstatsplot::ggbetweenstats(
data = portugais, x = internet, y = G3,
title = "La note finale en fonction du temps de voyage",
mean.ci = TRUE,
type="p",
var.equal = F,
bf.message = FALSE,
)
#Les variances sont proche
#vérifions la normalité
qqnorm(pG3[pInternet == "yes"])
qqline(pG3[pInternet == "yes"], col = "red")
qqnorm(pG3[pInternet == "no"])
qqline(pG3[pInternet == "no"], col = "red")
#Les données suivent une loi normale
t.test(G3 ~ internet, data = portugais, var.equal = T)
#p-value = 0.0009197, très significatif, l'internet semblent améliorer les notes de portugais
###############################################
# Variable mDalc
psych::describeBy(mG3, group = mDalc)
#Les variances semblent différent
ggstatsplot::ggbetweenstats(
data = mathematique, x = Dalc, y = G3,
title = "La note finale en fonction du temps de voyage",
mean.ci = TRUE,
type="p",
var.equal = F,
bf.message = FALSE,
)
ggstatsplot::ggbetweenstats(
data = mathematique, x = Dalc, y = logG3,
title = "La note finale en fonction du temps de voyage",
mean.ci = TRUE,
type="p",
var.equal = F,
bf.message = FALSE,
)
#la transformation log améliore, mais pas beaucoup
#on vérifie la normalité
qqnorm(mG3[mDalc == 1])
qqline(mG3[mDalc == 1], col = "red")
qqnorm(mG3[mDalc == 2])
qqline(mG3[mDalc == 2], col = "red")
qqnorm(mG3[mDalc == 3])
qqline(mG3[mDalc == 3], col = "red")
qqnorm(mG3[mDalc == 4])
qqline(mG3[mDalc == 4], col = "red")
qqnorm(mG3[mDalc == 5])
qqline(mG3[mDalc == 5], col = "red")
#les données suivent une loi normale, difficile d'exclure pour les niveaux 4 et 5 (peu d'observations)
groupe1 <- mG3[mDalc == 1]
groupe2 <- mG3[mDalc == 2]
groupe3 <- mG3[mDalc == 3]
groupe4 <- mG3[mDalc == 4]
groupe5 <- mG3[mDalc == 5]
p_values <- c(
t.test(groupe1, groupe2, var.equal = F)$p.value,
t.test(groupe1, groupe3, var.equal = F)$p.value,
t.test(groupe1, groupe4, var.equal = F)$p.value,
t.test(groupe1, groupe5, var.equal = F)$p.value,
t.test(groupe2, groupe3, var.equal = F)$p.value,
t.test(groupe2, groupe4, var.equal = F)$p.value,
t.test(groupe2, groupe5, var.equal = F)$p.value,
t.test(groupe3, groupe4, var.equal = F)$p.value,
t.test(groupe3, groupe5, var.equal = F)$p.value
)
# Ajuster les p-valeurs pour les comparaisons multiples (Bonferroni)
p_values_adjusted <- p.adjust(p_values, method = "bonferroni")
# Afficher les résultats ajustés
p_values_adjusted
#0.3705751 1.0000000 0.5144004 1.0000000 1.0000000 1.0000000 1.0000000 1.0000000 1.0000000
#Il y a aucune différence significative, boire la semaine ne semblent pas changer les notes de mathématique
#-----------------------
#portugais
psych::describeBy(pG3, group = PDalc)
#Les variances sont assez différentes
ggstatsplot::ggbetweenstats(
data = portugais, x = Dalc, y = G3,
title = "La note finale en fonction du temps de voyage",
mean.ci = TRUE,
type="p",
var.equal = F,
bf.message = FALSE,
)
#la transformation log améliore, mais pas beaucoup
#on vérifie la normalité
qqnorm(pG3[PDalc == 1])
qqline(pG3[PDalc == 1], col = "red")
qqnorm(pG3[PDalc == 2])
qqline(pG3[PDalc == 2], col = "red")
qqnorm(pG3[PDalc == 3])
qqline(pG3[PDalc == 3], col = "red")
qqnorm(pG3[PDalc == 4])
qqline(pG3[PDalc == 4], col = "red")
qqnorm(pG3[PDalc == 5])
qqline(pG3[PDalc == 5], col = "red")
#les données suivent une loi normale, difficile d'exclure pour les niveaux 4 et 5 (peu d'observations)
groupe1 <- pG3[PDalc == 1]
groupe2 <- pG3[PDalc == 2]
groupe3 <- pG3[PDalc == 3]
groupe4 <- pG3[PDalc == 4]
groupe5 <- pG3[PDalc == 5]
p_values <- c(
t.test(groupe1, groupe2, var.equal = F)$p.value,
t.test(groupe1, groupe3, var.equal = F)$p.value,
t.test(groupe1, groupe4, var.equal = F)$p.value,
t.test(groupe1, groupe5, var.equal = F)$p.value,
t.test(groupe2, groupe3, var.equal = F)$p.value,
t.test(groupe2, groupe4, var.equal = F)$p.value,
t.test(groupe2, groupe5, var.equal = F)$p.value,
t.test(groupe3, groupe4, var.equal = F)$p.value,
t.test(groupe3, groupe5, var.equal = F)$p.value
)
# Ajuster les p-valeurs pour les comparaisons multiples (Bonferroni)
p_values_adjusted <- p.adjust(p_values, method = "bonferroni")
# Afficher les résultats ajustés
p_values_adjusted
#[1] 0.048103725 0.003579952 0.435058880 0.052687767 1.000000000 1.000000000 0.524709947 1.000000000 1.000000000
#Difficile à interprêter, il semble avoir une différence significative entre 1 et 2 et entre 1 et 3, mais presque pas
#significative entre 1 et 5, alors que la moyenne et la médiane sont toutes 2 bien inférieur au groupe 1
##########################
# variable walc
psych::describeBy(mG3, group = mWalc)
#Les variances semblent différent
ggstatsplot::ggbetweenstats(
data = mathematique, x = Walc, y = G3,
title = "La note finale en fonction du temps de voyage",
mean.ci = TRUE,
type="p",
var.equal = F,
bf.message = FALSE,
)
#Les variance semblent finalement très proche
#on vérifie la normalité
qqnorm(mG3[mWalc == 1])
qqline(mG3[mWalc == 1], col = "red")
qqnorm(mG3[mWalc == 2])
qqline(mG3[mWalc == 2], col = "red")
qqnorm(mG3[mWalc == 3])
qqline(mG3[mWalc == 3], col = "red")
qqnorm(mG3[mWalc == 4])
qqline(mG3[mWalc == 4], col = "red")
qqnorm(mG3[mWalc == 5])
qqline(mG3[mWalc == 5], col = "red")
#les données suivent une loi normale,
groupe1 <- mG3[mWalc == 1]
groupe2 <- mG3[mWalc == 2]
groupe3 <- mG3[mWalc == 3]
groupe4 <- mG3[mWalc == 4]
groupe5 <- mG3[mWalc == 5]
p_values <- c(
t.test(groupe1, groupe2, var.equal = T)$p.value,
t.test(groupe1, groupe3, var.equal = T)$p.value,
t.test(groupe1, groupe4, var.equal = T)$p.value,
t.test(groupe1, groupe5, var.equal = T)$p.value,
t.test(groupe2, groupe3, var.equal = T)$p.value,
t.test(groupe2, groupe4, var.equal = T)$p.value,
t.test(groupe2, groupe5, var.equal = T)$p.value,
t.test(groupe3, groupe4, var.equal = T)$p.value,
t.test(groupe3, groupe5, var.equal = T)$p.value
)
# Ajuster les p-valeurs pour les comparaisons multiples (Bonferroni)
p_values_adjusted <- p.adjust(p_values, method = "bonferroni")
# Afficher les résultats ajustés
p_values_adjusted
#[1] 1.00000000 0.27039427 0.01628743 0.77862114 1.00000000 0.13375697 1.00000000 1.00000000 1.00000000
#Il y a une différence entre les groupe, certain entre 1 et 3
#-----------------------
#portugais
psych::describeBy(pG3, group = pWalc)
#Les variances semblent proche
ggstatsplot::ggbetweenstats(
data = portugais, x = Walc, y = G3,
title = "La note finale en fonction du temps de voyage",
mean.ci = TRUE,
type="p",
var.equal = F,
bf.message = FALSE,
)
qqnorm(pG3[pWalc == 1])
qqline(pG3[pWalc == 1], col = "red")
qqnorm(pG3[pWalc == 2])
qqline(pG3[pWalc == 2], col = "red")
qqnorm(pG3[pWalc == 3])
qqline(pG3[pWalc == 3], col = "red")
qqnorm(pG3[pWalc == 4])
qqline(pG3[pWalc == 4], col = "red")
qqnorm(pG3[pWalc == 5])
qqline(pG3[pWalc == 5], col = "red")
#les données suivent une loi normale
groupe1 <- pG3[pWalc == 1]
groupe2 <- pG3[pWalc == 2]
groupe3 <- pG3[pWalc == 3]
groupe4 <- pG3[pWalc == 4]
groupe5 <- pG3[pWalc == 5]
p_values <- c(
t.test(groupe1, groupe2, var.equal = T)$p.value,
t.test(groupe1, groupe3, var.equal = T)$p.value,
t.test(groupe1, groupe4, var.equal = T)$p.value,
t.test(groupe1, groupe5, var.equal = T)$p.value,
t.test(groupe2, groupe3, var.equal = T)$p.value,
t.test(groupe2, groupe4, var.equal = T)$p.value,
t.test(groupe2, groupe5, var.equal = T)$p.value,
t.test(groupe3, groupe4, var.equal = T)$p.value,
t.test(groupe3, groupe5, var.equal = T)$p.value
)
# Ajuster les p-valeurs pour les comparaisons multiples (Bonferroni)
p_values_adjusted <- p.adjust(p_values, method = "bonferroni")
# Afficher les résultats ajustés
p_values_adjusted
#1.0000000000 1.0000000000 0.0007616568 0.0058612511 1.0000000000 0.0127945398 0.0401602842 0.0421373683 0.0802960388
#au moins un des groupe est différent, le groupe 1 et (1,4) et (1,5). Boire de l'alcool les fds c'est pas bon pour le portugais
ggstatsplot::ggbetweenstats(
data = portugais, x = Walc, y = G3,
title = "La note finale en fonction du temps de voyage",
mean.ci = TRUE,
type = "p",
var.equal = FALSE,
bf.message = FALSE,
results.subtitle = FALSE, # Cela devrait retirer les résultats du test de Welch de l'affichage
pairwise.comparisons = FALSE # Cela devrait retirer les annotations des comparaisons par paires
)
ggstatsplot::ggbetweenstats(
data = mathematique, x = paid, y = G3,
title = "La note finale en fonction du temps de voyage",
mean.ci = TRUE,
type="p",
var.equal = F,
bf.message = FALSE,
)
t.test(logG3 ~ paid, data = portugais, var.equal = F)
portugais$failures
# Chargement de la bibliothèque dplyr
library(dplyr)
# Filtrer les données pour enlever les lignes où paid == "yes" et failures > 0
portugais_filtered <- portugais %>%
filter(!(paid == "yes" & failures > 0))
# Vérifiez le résultat
print(portugais_filtered)
which(portugais_filtered$failures > 0)
portugais_filtered$failures
paid == "yes" & failures
View(portugais_filtered)
ggstatsplot::ggbetweenstats(
data = portugais, x = paid, y = G3,
title = "La note finale en fonction du temps de voyage",
mean.ci = TRUE,
type="p",
var.equal = F,
bf.message = FALSE,
)
ggstatsplot::ggbetweenstats(
data = portugais_filtered, x = paid, y = G3,
title = "La note finale en fonction du temps de voyage",
mean.ci = TRUE,
type="p",
var.equal = F,
bf.message = FALSE,
)
portugais_filtered <- portugais %>%
filter(!(paid == "no" & failures > 0))
View(portugais_filtered)
# Filtrer les données pour enlever les lignes où paid == "yes" et failures > 0
portugais_filtered <- portugais %>%
filter(!(paid == "yes" & failures > 0))
portugais_filtered <- portugais_filtered %>%
filter(!(paid == "no" & failures > 0))
View(portugais_filtered)
ggstatsplot::ggbetweenstats(
data = portugais_filtered, x = paid, y = G3,
title = "La note finale en fonction du temps de voyage",
mean.ci = TRUE,
type="p",
var.equal = F,
bf.message = FALSE,
)
t.test(G3 ~ paid, data = portugais_filtered, var.equal = F)
t.test(G3 ~ schoolsup, data = portugais_filtered, var.equal = F)
#En enlevant les échecs, c'est encore plus significatif
ggstatsplot::ggbetweenstats(
data = portugais_filtered, x = schoolsup, y = G3,
title = "La note finale en fonction du temps de voyage",
mean.ci = TRUE,
type="p",
var.equal = F,
bf.message = FALSE,
)
